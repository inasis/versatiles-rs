---
name: CI

on:
   push:
   pull_request:
   schedule:
      - cron: '0 0 15 * *'
   workflow_dispatch:
      inputs:
         logLevel:
            description: 'Log level'
            required: true
            default: 'warning'
         tags:
            description: 'Test scenario tags'

env:
   CARGO_TERM_COLOR: always

jobs:
   checks:
      name: checks
      runs-on: ubuntu-18.04

      steps:
         - name: Checkout repository
           uses: actions/checkout@v3
           with: { submodules: true }

         - name: Install rust
           uses: actions-rs/toolchain@v1
           with:
              toolchain: stable
              profile: minimal
              components: rustfmt, clippy

         - name: cargo fmt
           run: cargo fmt -- --check

         - name: cargo clippy
           run: cargo clippy -- -D warnings

         - name: cargo build
           run: cargo build

         - name: cargo test
           run: cargo test
